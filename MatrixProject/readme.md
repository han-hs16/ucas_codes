# 要求
要求完成课堂上讲的关于矩阵分解的LU、QR（Gram-Schmidt）、Orthogonal Reduction (Householder reduction 和Givens reduction)和 URV程序实现，要求如下：
  - 一个综合程序，根据选择参数的不同，实现不同的矩阵分解；
  - 可以用matlab、Python等编写程序，需附上简单的程序说明，比如参数代表什么意思，输入什么，输出什么等等，附上相应的例子；
  - 一定是可执行文件，例如 .m文件等,不能是word或者txt文档。附上源代码，不能为直接调用matlab等函数库;


# 运行环境
- python 3.7.8
- numpy 1.19.2
- scipy 1.5.2

# 代码结构
```
- MAproject.py                      # 所有代码，因为代码量不大，集成在一个文件中，便于查看
  - LU()                            # LU分解，输入A矩阵，返回P, L, U。
  - LUVerification()                # 验证LU分解的正确性，输入A, P, L, U，验证 P*A = L*U
  
  - Householder()                   # Householder正交约化，输入A，返回P, T。 
  - Given()                         # Given正交约化，输入A，返回P,T
  - orthoReductionVerification()    # 验证Householder和Given的正确性，输入A, P, T。 验证 P*P.T == I  
  
  - QR()                            # QR分解，输入A，返回Q,R
  - QRVerification()                # 验证QR分解的正确性，输入A, Q, R。验证 Q*R == A, 同时当Q为非奇异矩阵时，验证Q.T*Q == I

  - URV()                           # URV分解， 输入A， 返回U, R, V
  - URVVerification()               # 验证URV分解的正确性，输入A, U, R, V。验证 U*R*V.T == A、U.T*U == I、 V.T*V == I
- data.txt                          # 存放预先设置的矩阵
- experiment.sh                     # 运行测试脚本 
- readme.md                         # 说明文件
```

# 运行
在命令行中的执行命令说明如下所示
```
usage: MAproject.py [-h] 
                    [--data {random,data.txt}]
                    [--method {LU,Householder,Given,QR,URV}] 
                    [--rows ROWS]
                    [--cols COLS] 
                    [--rank RANK]
```
python MAproject.py后共有5个选项，分别为
- data：  设置载入数据的方式，可设置为"data.txt", 从当前文件夹下的data.txt文件中直接载入； 设置为"random"时，结合后续的rows、cols和rank生成随机矩阵
- method： 设置对矩阵的操作，可设置为LU、Householder、Given、QR、URV
- rows: 设置随机生成矩阵的行数，当且仅当data设置为"random"时有效
- cols：设置随机生成矩阵的列数，当且仅当data设置为"random"时有效
- rank: 设置随机生成矩阵的秩，当且仅当data设置为"random"时有效

# 运行示例
experiments.sh中展示了各种可能出现的运行实例，这里按命令与结果的方式贴出运行过程

## 实例1： data.txt,  LU方法
- 代码

  ```python MAproject.py --data data.txt --method LU```

- 结果
  ```
  =====================================   BEGIN ================================================
  test method:  LU
  shape of matrix A (4, 4)
  matrix A:
  [[ 1. -3.  4.  2.]
  [ 4. 12. -8.  8.]
  [ 2.  2.  1.  4.]
  [-2.  1. -4. -4.]]
  P:
  [[0. 1. 0. 0.]
  [0. 0. 0. 1.]
  [1. 0. 0. 0.]
  [0. 0. 1. 0.]]
  L:
  [[ 1.      0.      0.      0.    ]
  [-0.5     1.      0.      0.    ]
  [ 0.25   -0.8571  1.      0.    ]
  [ 0.5    -0.5714 -0.5     1.    ]]
  U:
  [[ 4.     12.     -8.      8.    ]
  [ 0.      7.     -8.      0.    ]
  [ 0.      0.     -0.8571  0.    ]
  [ 0.      0.     -0.      0.    ]]
  P*A:
  [[ 4. 12. -8.  8.]
  [-2.  1. -4. -4.]
  [ 1. -3.  4.  2.]
  [ 2.  2.  1.  4.]]
  L*U:
  [[ 4. 12. -8.  8.]
  [-2.  1. -4. -4.]
  [ 1. -3.  4.  2.]
  [ 2.  2.  1.  4.]]
  norm of (P*A-L*U): 4.44e-16
  LU succeed!
  =====================================    END =================================================
  ```


## 实例2：data.txt,  QR方法
- 代码

  ``` python MAproject.py --data data.txt --method QR ```

- 结果
  ```
  =====================================   BEGIN ================================================
  test method:  QR
  shape of matrix A (4, 4)
  matrix A:
  [[ 1. -3.  4.  2.]
  [ 4. 12. -8.  8.]
  [ 2.  2.  1.  4.]
  [-2.  1. -4. -4.]]
  Q
  [[ 0.2    -0.5848 -0.7125  0.5813]
  [ 0.8     0.5368 -0.2548  0.3322]
  [ 0.4    -0.2109  0.5951 -0.6644]
  [-0.4     0.5704 -0.2707  0.3322]]
  R
  [[ 5.      9.4    -3.6    10.    ]
  [ 0.      8.3451 -9.1264 -0.    ]
  [ 0.      0.      0.8658  0.    ]
  [ 0.      0.      0.      0.    ]]
  norm of (A - Q*R): 1.33e-15
  QR succeed!
  =====================================    END =================================================
  ```



## 实例3：从data.txt载入数据， Householder方法
- 代码

  ```python MAproject.py --data data.txt --method Householder ```

- 结果
  ```
  =====================================   BEGIN ================================================
  test method:  Householder
  shape of matrix A (4, 4)
  matrix A:
  [[ 1. -3.  4.  2.]
  [ 4. 12. -8.  8.]
  [ 2.  2.  1.  4.]
  [-2.  1. -4. -4.]]
  P
  [[ 0.2     0.8     0.4    -0.4   ]
  [-0.5848  0.5368 -0.2109  0.5704]
  [-0.7125 -0.2548  0.5951 -0.2707]
  [-0.3322  0.083  -0.6644 -0.6644]]
  T
  [[ 5.      9.4    -3.6    10.    ]
  [-0.      8.3451 -9.1264  0.    ]
  [-0.      0.      0.8658  0.    ]
  [ 0.     -0.     -0.      0.    ]]
  norm of (P.T*P-I): 4.73e-16
  norm of (P*A-T): 2.02e-15
  reduction succeed!
  =====================================    END =================================================
  ```



## 实例4：从data.txt载入数据， Given方法
- 代码

  ```python MAproject.py --data data.txt --method Given ```

- 结果
  ```
  =====================================   BEGIN ================================================
  test method:  Given
  shape of matrix A (4, 4)
  matrix A:
  [[ 1. -3.  4.  2.]
  [ 4. 12. -8.  8.]
  [ 2.  2.  1.  4.]
  [-2.  1. -4. -4.]]
  P
  [[ 0.2     0.8     0.4    -0.4   ]
  [-0.5848  0.5368 -0.2109  0.5704]
  [-0.7125 -0.2548  0.5951 -0.2707]
  [ 0.3322 -0.083   0.6644  0.6644]]
  T
  [[ 5.      9.4    -3.6    10.    ]
  [ 0.      8.3451 -9.1264  0.    ]
  [ 0.     -0.      0.8658  0.    ]
  [ 0.      0.      0.      0.    ]]
  norm of (P.T*P-I): 5.01e-16
  norm of (P*A-T): 2.56e-15
  reduction succeed!
  =====================================    END =================================================
  ```





## 实例5：实例：从data.txt载入数据， URV方法
- 代码

  ```python MAproject.py --data data.txt --method URV ```

- 结果
  ```
  =====================================   BEGIN ================================================
  test method:  URV
  shape of matrix A (4, 4)
  matrix A:
  [[ 1. -3.  4.  2.]
  [ 4. 12. -8.  8.]
  [ 2.  2.  1.  4.]
  [-2.  1. -4. -4.]]
  U:
  [[ 0.2    -0.5848 -0.7125 -0.3322]
  [ 0.8     0.5368 -0.2548  0.083 ]
  [ 0.4    -0.2109  0.5951 -0.6644]
  [-0.4     0.5704 -0.2707 -0.6644]]
  R:
  [[15.0439  0.      0.      0.    ]
  [ 7.3982  9.9094 -0.     -0.    ]
  [-0.2072 -0.6427  0.5419  0.    ]
  [ 0.      0.      0.      0.    ]]
  V:
  [[ 0.3324 -0.2481 -0.1672  0.8944]
  [ 0.6248  0.3756  0.6845  0.    ]
  [-0.2393 -0.7423  0.6259  0.    ]
  [ 0.6647 -0.4963 -0.3345 -0.4472]]
  norm of (U*R*V.T - A): 4.83e-15
  norm of (U.T*U -I ): 4.90e-16
  norm of (V.T*V -I ): 3.65e-16
  URV succeed!
  =====================================    END =================================================
  ```





## 实例6： 随机生成4行4列矩阵，LU方法
- 代码

  ```python MAproject.py --data random --method LU --rows 4 --cols 4 ```

- 结果
  ```
  =====================================   BEGIN ================================================
  test method:  LU
  shape of matrix A (4, 4)
  matrix A:
  [[0.4077 0.0554 0.7885 0.2873]
  [0.4504 0.3039 0.5264 0.6238]
  [0.7768 0.6862 0.9809 0.6008]
  [0.814  0.7086 0.0275 0.9043]]
  P:
  [[0. 0. 0. 1.]
  [1. 0. 0. 0.]
  [0. 0. 1. 0.]
  [0. 1. 0. 0.]]
  L:
  [[ 1.      0.      0.      0.    ]
  [ 0.5009  1.      0.      0.    ]
  [ 0.9543 -0.0333  1.      0.    ]
  [ 0.5533  0.2943  0.2888  1.    ]]
  U:
  [[ 0.814   0.7086  0.0275  0.9043]
  [ 0.     -0.2996  0.7747 -0.1656]
  [ 0.     -0.      0.9805 -0.2676]
  [ 0.      0.      0.      0.2495]]
  P*A:
  [[0.814  0.7086 0.0275 0.9043]
  [0.4077 0.0554 0.7885 0.2873]
  [0.7768 0.6862 0.9809 0.6008]
  [0.4504 0.3039 0.5264 0.6238]]
  L*U:
  [[0.814  0.7086 0.0275 0.9043]
  [0.4077 0.0554 0.7885 0.2873]
  [0.7768 0.6862 0.9809 0.6008]
  [0.4504 0.3039 0.5264 0.6238]]
  norm of (P*A-L*U): 1.11e-16
  LU succeed!
  =====================================    END =================================================
  ```




## 实例7：随机生成5行4列矩阵，QR方法
- 代码

  ```python MAproject.py --data random --method QR --rows 4 --cols 5 ```

- 结果
  ```
  =====================================   BEGIN ================================================
  test method:  QR
  shape of matrix A (4, 5)
  matrix A:
  [[0.4077 0.0554 0.7885 0.2873 0.4504]
  [0.3039 0.5264 0.6238 0.7768 0.6862]
  [0.9809 0.6008 0.814  0.7086 0.0275]
  [0.9043 0.4499 0.1189 0.8353 0.2022]]
  Q
  [[ 0.2855 -0.4482  0.76    0.3741  0.1455]
  [ 0.2129  0.8714  0.2567  0.3599 -0.9456]
  [ 0.687   0.0835  0.1397 -0.7082  0.291 ]
  [ 0.6333 -0.1813 -0.5805  0.4786  0.    ]]
  R
  [[1.4278 0.8256 0.9925 1.2633 0.4217]
  [0.     0.4024 0.2365 0.4558 0.3617]
  [0.     0.     0.8041 0.0319 0.4049]
  [0.     0.     0.     0.285  0.4927]
  [0.     0.     0.     0.     0.    ]]
  norm of (A - Q*R): 1.17e-16
  QR succeed!
  =====================================    END =================================================
  ```



## 实例8：随机生成5行4列矩阵，Householder方法
- 代码

  ```python MAproject.py --data random --method Householder --rows 5 --cols 4 ```

- 结果
  ```
  =====================================   BEGIN ================================================
  test method:  Householder
  shape of matrix A (5, 4)
  matrix A:
  [[0.4077 0.0554 0.7885 0.2873]
  [0.4504 0.3039 0.5264 0.6238]
  [0.7768 0.6862 0.9809 0.6008]
  [0.814  0.7086 0.0275 0.9043]
  [0.4499 0.1189 0.8353 0.2022]]
  P
  [[ 0.3008  0.3322  0.5731  0.6005  0.3319]
  [-0.6597 -0.0563  0.3518  0.3397 -0.5678]
  [-0.0488  0.095   0.6905 -0.7137  0.0482]
  [ 0.0808  0.8876 -0.2115 -0.1178 -0.3834]
  [ 0.6822 -0.2992  0.162   0.0266 -0.6466]]
  T
  [[ 1.3555  0.9759  1.268   1.2481]
  [ 0.      0.361  -0.6697  0.1791]
  [-0.     -0.      0.7095 -0.1755]
  [-0.     -0.     -0.      0.2658]
  [-0.     -0.     -0.      0.    ]]
  norm of (P.T*P-I): 6.99e-16
  norm of (P*A-T): 3.09e-16
  reduction succeed!
  =====================================    END =================================================
  ```





## 实例9：随机生成5行4列矩阵，Given方法
- 代码

  ```python MAproject.py --data random --method Given --rows 5 --cols 4 ```

- 结果
  ```
  =====================================   BEGIN ================================================
  test method:  Given
  shape of matrix A (5, 4)
  matrix A:
  [[0.4077 0.0554 0.7885 0.2873]
  [0.4504 0.3039 0.5264 0.6238]
  [0.7768 0.6862 0.9809 0.6008]
  [0.814  0.7086 0.0275 0.9043]
  [0.4499 0.1189 0.8353 0.2022]]
  P
  [[ 0.3008  0.3322  0.5731  0.6005  0.3319]
  [-0.6597 -0.0563  0.3518  0.3397 -0.5678]
  [-0.0488  0.095   0.6905 -0.7137  0.0482]
  [ 0.0808  0.8876 -0.2115 -0.1178 -0.3834]
  [ 0.6822 -0.2992  0.162   0.0266 -0.6466]]
  T
  [[ 1.3555  0.9759  1.268   1.2481]
  [-0.      0.361  -0.6697  0.1791]
  [-0.      0.      0.7095 -0.1755]
  [-0.     -0.      0.      0.2658]
  [-0.      0.     -0.     -0.    ]]
  norm of (P.T*P-I): 5.43e-16
  norm of (P*A-T): 3.53e-16
  reduction succeed!
  =====================================    END =================================================

  ```


## 实例10：随机生成5行4列且秩为3的矩阵，URV方法
- 代码

  ```python MAproject.py --data random --method URV --rows 5 --cols 4 --rank 3 ```

- 结果
  ```
  =====================================   BEGIN ================================================
  test method:  URV
  shape of matrix A (5, 4)
  matrix A:
  [[ 0.2404 -1.2871 -0.2017 -0.1355]
  [ 0.2399 -0.2786 -0.1094  0.0481]
  [-0.3077  0.7059  0.1611  0.0306]
  [ 0.0514 -0.9185 -0.052  -0.2758]
  [-0.0756 -0.8589 -0.1403  0.0412]]
  U:
  [[ 0.5144 -0.4312  0.0204  0.3176 -0.6695]
  [ 0.5133  0.2335 -0.2458 -0.7772 -0.1322]
  [-0.6585 -0.0695  0.1018 -0.3795 -0.6381]
  [ 0.11   -0.5168  0.7216 -0.3568  0.27  ]
  [-0.1618 -0.6983 -0.6388 -0.1542  0.2329]]
  R:
  [[ 1.3449 -0.     -0.     -0.    ]
  [-1.4343  0.5499 -0.      0.    ]
  [ 0.0011 -0.0461  0.2495  0.    ]
  [ 0.      0.      0.      0.    ]
  [ 0.      0.      0.      0.    ]]
  V:
  [[ 0.3475  0.9064  0.1661 -0.1736]
  [-0.9161  0.3662  0.0717  0.1469]
  [-0.1852 -0.1646  0.336  -0.9087]
  [-0.076   0.1315 -0.9243 -0.3501]]
  norm of (U*R*V.T - A): 9.93e-16
  norm of (U.T*U -I ): 5.91e-16
  norm of (V.T*V -I ): 1.23e-15
  URV succeed!
  =====================================    END =================================================
  ```
